# 羊了个羊（Cocos版本）

基于 **Cocos Creator 3.8.6** 开发的消除类益智游戏，使用 **TypeScript** 语言编写。

## 项目结构

```
Cocos/SheepProject/
├── assets/
│   ├── Scripts/              # 脚本文件
│   │   ├── GameManager.ts    # 游戏主管理器
│   │   ├── Block.ts          # 方块组件
│   │   ├── DataManager.ts    # 数据管理器
│   │   ├── MenuManager.ts    # 菜单管理器
│   │   ├── MusicManager.ts   # 音频管理器
│   │   ├── BrokenManager.ts  # 特效管理器
│   │   ├── SheepMove.ts      # 羊移动组件
│   │   ├── Enum.ts           # 枚举定义
│   │   ├── Event.ts          # 事件系统
│   │   ├── Level.ts          # 关卡配置
│   │   ├── Utils.ts          # 工具函数
│   │   └── type.d.ts         # 类型定义
│   ├── Scenes/               # 场景文件
│   │   ├── Menu.scene        # 主菜单场景
│   │   └── Game.scene        # 游戏场景
│   ├── Prefabs/              # 预制体
│   │   ├── Block.prefab      # 方块预制体
│   │   ├── Sheep.prefab      # 羊预制体
│   │   └── broken*.prefab    # 特效预制体
│   ├── Sprites/              # 图片资源
│   │   ├── Card/             # 卡牌图片
│   │   ├── BrokenCard/       # 破碎卡牌动画
│   │   └── Other/            # 其他UI图片
│   ├── Audio/                # 音频资源
│   │   ├── bgm.mp3          # 背景音乐
│   │   ├── click.mp3        # 点击音效
│   │   ├── clear.mp3        # 消除音效
│   │   ├── win.mp3          # 胜利音效
│   │   └── lose.mp3         # 失败音效
│   └── AnimationClip/        # 动画文件
│       ├── SheepWalk.anim   # 羊行走动画
│       └── Clear.anim       # 消除动画
├── package.json              # 项目配置
└── tsconfig.json            # TypeScript配置
```

## 核心功能

- **多层消除**: 三层重叠的方块消除机制
- **槽位系统**: 7个槽位临时存放方块
- **随机区块**: 左右两侧随机方块区域
- **扩展区域**: 技能系统，可移动方块到扩展区
- **撤销功能**: 支持撤销上一步操作
- **洗牌功能**: 重新排列剩余方块
- **关卡系统**: 4个难度递增的关卡
- **音效系统**: 完整的游戏音效和背景音乐

## 开发设计架构

### 核心类设计
```
GameManager (游戏主管理器)
├── 游戏状态管理 (INIT/RUNNING/CLEAR/LOSED/COMPLETE)
├── 关卡初始化
├── 技能系统 (扩展/撤销/洗牌)
├── 事件监听处理
└── 游戏结束判定

Block (方块组件)
├── 位置和尺寸管理
├── 层级关系 (higherIds/lowerIds)
├── 点击判定逻辑
├── 渲染更新
└── 移动动画

DataManager (数据管理器)
├── 游戏数据持久化
├── 方块数据管理
├── 操作记录栈
└── 关卡进度管理

Board System (棋盘系统)
├── LEVEL (主游戏区)
├── LEVEL_EXTEND (扩展区)
├── RANDOM_LEFT/RIGHT (随机区)
├── SLOT (槽位区)
└── HIDE (隐藏区)

UI System (界面系统)
├── MenuManager (菜单管理)
├── MusicManager (音频管理)
└── BrokenManager (特效管理)
```

### 游戏机制

#### 消除规则
- 相同类型的方块需要收集3个才能消除
- 方块必须没有被其他方块覆盖才能点击
- 消除后会产生特效动画

#### 槽位系统
- 最多7个槽位
- 槽位满时无法继续操作
- 槽位中的方块可以随时消除

#### 技能系统
- **扩展**: 将槽位中的方块移动到扩展区
- **撤销**: 撤销上一步操作
- **洗牌**: 重新排列剩余方块

#### 关卡设计
```typescript
关卡1: 2层，9块/层，3种类型，无随机区
关卡2: 4层，9块/层，6种类型，左右各4个随机块
关卡3: 8层，16块/层，12种类型，左右各6个随机块
关卡4: 10层，18块/层，14种类型，左右各8个随机块
```

## 编译运行

1. 使用 **Cocos Creator 3.8.6** 打开项目
2. 在编辑器中点击运行按钮
3. 或构建发布到目标平台

## 游戏玩法

1. **开始游戏**: 点击开始按钮进入游戏
2. **消除方块**: 点击未被覆盖的相同类型方块，收集3个后自动消除
3. **使用槽位**: 点击方块将其放入槽位，槽位中的方块可以随时消除
4. **技能使用**: 
   - 扩展: 将槽位方块移到扩展区
   - 撤销: 撤销上一步操作
   - 洗牌: 重新排列剩余方块
5. **完成关卡**: 消除所有方块即可过关
6. **失败条件**: 无法继续消除时游戏失败

## 技术特点

- **TypeScript**: 强类型编程，提高代码质量
- **组件化设计**: 模块化的代码结构
- **事件驱动**: 基于事件的松耦合架构
- **数据持久化**: 自动保存游戏进度
- **动画系统**: 流畅的消除和移动动画
- **音效系统**: 完整的游戏音效体验
